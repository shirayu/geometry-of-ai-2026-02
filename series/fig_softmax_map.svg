<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 620 360" font-family="'STIX Two Math', 'Latin Modern Math', 'Cambria Math', serif">
  <defs>
    <style>
      .label { font-size: 14px; fill: #1a1a2e; }
      .label-sm { font-size: 12px; fill: #555; }
      .label-math { font-size: 15px; fill: #1a1a2e; font-style: italic; }
      .title { font-size: 16px; fill: #1a1a2e; font-weight: 600; }
      .annotation { font-size: 11.5px; fill: #444; }
    </style>
    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#888"/>
    </marker>
    <!-- Gradient for logit space -->
    <linearGradient id="logitBg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#f0f0f8"/>
      <stop offset="100%" stop-color="#e2e2f0"/>
    </linearGradient>
  </defs>

  <!-- Title -->
  <text x="310" y="28" text-anchor="middle" class="title">Softmax写像：ℝᴷ → int(Δᴷ⁻¹)</text>

  <!-- ===== Left: Logit space R^K ===== -->
  <rect x="20" y="50" width="200" height="260" rx="8" fill="url(#logitBg)" stroke="#999" stroke-width="1.2"/>
  <text x="120" y="75" text-anchor="middle" class="label" font-weight="600">ロジット空間 ℝᴷ</text>

  <!-- Grid lines to suggest Euclidean space -->
  <g opacity="0.15" stroke="#666" stroke-width="0.5">
    <line x1="40" y1="100" x2="40" y2="290"/>
    <line x1="80" y1="100" x2="80" y2="290"/>
    <line x1="120" y1="100" x2="120" y2="290"/>
    <line x1="160" y1="100" x2="160" y2="290"/>
    <line x1="200" y1="100" x2="200" y2="290"/>
    <line x1="40" y1="130" x2="200" y2="130"/>
    <line x1="40" y1="170" x2="200" y2="170"/>
    <line x1="40" y1="210" x2="200" y2="210"/>
    <line x1="40" y1="250" x2="200" y2="250"/>
  </g>

  <!-- Sample points in R^K -->
  <circle cx="70" cy="130" r="4.5" fill="#e67e22"/>
  <text x="80" y="127" class="label-sm" fill="#e67e22">z₁ = (5, 1, 0)</text>

  <circle cx="150" cy="190" r="4.5" fill="#e67e22"/>
  <text x="77" y="200" class="label-sm" fill="#e67e22">z₂ = (1, 1, 1)</text>

  <circle cx="100" cy="250" r="4.5" fill="#e67e22"/>
  <text x="110" y="253" class="label-sm" fill="#e67e22">z₃ = (−2, 0, 3)</text>

  <!-- Points on 1-direction (same image) -->
  <circle cx="130" cy="155" r="3.5" fill="#9b59b6" opacity="0.7"/>
  <circle cx="170" cy="175" r="3.5" fill="#9b59b6" opacity="0.7"/>
  <line x1="130" y1="155" x2="170" y2="175" stroke="#9b59b6" stroke-width="1" stroke-dasharray="3,2" opacity="0.6"/>
  <text x="130" y="148" class="annotation" fill="#9b59b6">z + c·𝟏</text>
  <text x="100" y="280" class="annotation" fill="#9b59b6">（𝟏方向に平行な点は</text>
  <text x="100" y="293" class="annotation" fill="#9b59b6">　同一の分布に写る）</text>

  <!-- ===== Arrow: Softmax ===== -->
  <line x1="235" y1="180" x2="325" y2="180" stroke="#2c3e50" stroke-width="2.5" marker-end="url(#arrowBlue)"/>
  <text x="280" y="170" text-anchor="middle" class="label" font-weight="600">Softmax</text>
  <text x="280" y="205" text-anchor="middle" class="annotation">exp(zᵢ) / Σ exp(zⱼ)</text>

  <!-- ===== Right: Simplex ===== -->
  <!-- Triangle: A(480,58) top, B(360,300) bottom-left, C(600,300) bottom-right -->
  <g>
    <!-- Interior fill -->
    <polygon points="480,58 360,300 600,300" fill="#dceefb" opacity="0.5"/>

    <!-- Boundary (red) -->
    <polygon points="480,58 360,300 600,300" fill="none" stroke="#e74c3c" stroke-width="2.2"/>

    <!-- Dashed interior contour -->
    <polygon points="480,78 378,290 582,290" fill="none" stroke="#3498db" stroke-width="1.2" stroke-dasharray="5,3"/>

    <!-- Vertex labels -->
    <circle cx="480" cy="58" r="5" fill="#e74c3c"/>
    <text x="498" y="56" class="label-sm" fill="#c0392b">(1,0,0)</text>
    <circle cx="360" cy="300" r="5" fill="#e74c3c"/>
    <text x="335" y="318" class="label-sm" fill="#c0392b">(0,1,0)</text>
    <circle cx="600" cy="300" r="5" fill="#e74c3c"/>
    <text x="590" y="318" class="label-sm" fill="#c0392b">(0,0,1)</text>

    <!-- Interior label -->
    <text x="480" y="235" text-anchor="middle" class="label" fill="#2471a3">int(Δ²)</text>
    <text x="480" y="250" text-anchor="middle" class="annotation" fill="#2471a3">滑らかな多様体</text>

    <!-- Mapped points -->
    <!-- z1=(5,1,0): softmax ≈ (0.94, 0.017, 0.006) → near top vertex -->
    <circle cx="478" cy="90" r="4.5" fill="#e67e22"/>
    <text x="498" y="95" class="annotation" fill="#e67e22">(.94,.02,.01)</text>

    <!-- z2=(1,1,1): softmax = (1/3,1/3,1/3) → center -->
    <circle cx="480" cy="220" r="4.5" fill="#e67e22"/>
    <!-- arrow from purple points also lands here -->
    <circle cx="480" cy="220" r="7" fill="none" stroke="#9b59b6" stroke-width="1.2" stroke-dasharray="3,2"/>

    <!-- z3=(-2,0,3): softmax ≈ (0.006, 0.047, 0.95) → near bottom-right -->
    <circle cx="582" cy="288" r="4.5" fill="#e67e22"/>
    <text x="537" y="278" class="annotation" fill="#e67e22">(.01,.05,.95)</text>

    <!-- Boundary annotation -->
    <text x="480" y="322" text-anchor="middle" class="annotation" fill="#c0392b">境界：到達不可能（pᵢ > 0 常に成立）</text>
  </g>

  <!-- Mapping arrows (gray, curved) -->
  <path d="M 74,130 C 180,80 320,60 475,88" fill="none" stroke="#bbb" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowGray)"/>
  <path d="M 154,190 C 250,180 380,200 476,219" fill="none" stroke="#bbb" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowGray)"/>
  <path d="M 104,250 C 200,280 420,300 578,289" fill="none" stroke="#bbb" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowGray)"/>

  <!-- Legend bar -->
  <rect x="340" y="335" width="280" height="22" rx="3" fill="#fafafa" stroke="#ccc" stroke-width="0.7"/>
  <line x1="352" y1="346" x2="372" y2="346" stroke="#e74c3c" stroke-width="2"/>
  <text x="376" y="350" class="annotation" fill="#c0392b">境界（特異）</text>
  <line x1="445" y1="346" x2="465" y2="346" stroke="#3498db" stroke-width="1.2" stroke-dasharray="5,3"/>
  <text x="469" y="350" class="annotation" fill="#2471a3">開内部（像の範囲）</text>
</svg>
