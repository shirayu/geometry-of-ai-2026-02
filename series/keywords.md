
# キーワード集

## 第0回：幾何学という言語 ～この講義の羅針盤～

### 空間の構造（多様体論）

空間がどのような「形」をしているかを記述する、本講義の最も基礎となる概念群。

| キーワード | 説明 |
| --- | --- |
| **多様体** (Manifold) | 局所的にはユークリッド空間だが、大域的には異なる構造を持つ空間。 |
| 多様体仮説 | 高次元データの実質的な構造は、低次元の多様体上に集中しているという仮説。 |
| **リーマン多様体** | 距離、角度、曲率を定義するために「リーマン計量」を導入した多様体。ただし計量が当然の前提の話では単に「多様体」とよぶこともある。 |
| **曲率** (Curvature) | 空間がどれだけ「平ら」から逸脱しているかの指標（正・ゼロ・負）。 |
| **次元の呪い/祝福** | 高次元空間特有の性質（ランダムなベクトルが直交しやすいなど）。 |

### 距離と移動（幾何学的操作）

空間内での「近さ」や「動き」を定義・制御するための道具。

| キーワード | 説明 |
| --- | --- |
| **測地線** (Geodesic) | 曲がった空間における局所的な最短経路。 |
| **リーマン計量** | 各点での距離や角度を測るための数学的装置。 |
| **球面線形補間** (Slerp) | 球面上の測地線に沿った自然な補間方法。 |
| 平行移動 | ベクトルを向きを変えずに移動させる操作（曲がった空間では元の位置に戻ると向きがズレる）。 |

### 確率と学習（情報幾何学）

幾何学を統計的な推論やニューラルネットワークの学習に結びつける概念。

| キーワード | 説明 |
| --- | --- |
| **情報幾何学** | 確率分布の空間を多様体として扱う学問。 |
| **フィッシャー情報行列** | 確率分布の「変化しやすさ」を反映したリーマン計量。 |
| **自然勾配** (Natural Gradient) | フィッシャー情報行列を用いて、分布空間での等しい変化量を目指す勾配補正手法。 |
| **Softmax**, **Attention** | 連続的な値を離散的な確率や重みに変換する「界面」の操作。 |

### 具体的な空間モデル

幾何学的制約を明示的に設計に取り入れた具体的なモデルや空間の分類。

| キーワード | 説明 |
| --- | --- |
| 球面 (Positive Curvature) | 正の曲率を持つ空間。nGPTやArcFaceなどで利用される。 |
| 双曲空間 (Negative Curvature) | 負の曲率を持つ空間。階層構造の表現に適している。 |
| ユークリッド空間 (Zero Curvature) | 古典的な機械学習（PCA、SVMなど）が前提とする平坦な空間。 |
| 位相 (Topology) | 形ではなく「穴」などの構造を扱う概念（TDAなど）。 |

## 第1回：かつての地図 ～平らな世界で戦っていた私たち～

### 空間の基本前提：ユークリッド幾何学

深層学習以前の機械学習が暗黙のうちに基礎としていた「平らな世界」の性質。

| キーワード | 説明 |
| --- | --- |
| **ユークリッド空間** | 直線、平行線、ピタゴラスの定理が成り立つ、日常的な感覚に近い「平らな」空間。 |
| **線形性** | データの構造が直線や平面（線形部分空間）で捉えられるという仮定。 |
| **等方性** | 空間のすべての方向が対称であり、等しく重要であるという性質。 |
| **ピタゴラスの定理** | 距離を成分の二乗和の平方根で計算する、ユークリッド空間における距離計算の基礎。 |

### 線形次元削減と投影：PCAとSVD

高次元データを低次元に落とし込み、可視化や分析を行うための古典的手法。

| キーワード | 説明 |
| --- | --- |
| **主成分分析 (PCA)** | 分散が最大になる方向を見つけ、データを線形射影する次元削減手法。 |
| **特異値分解 (SVD)** | 行列を3つの行列に分解する手法。PCAの主成分抽出と密接に関連する。 |
| **線形射影** | 高次元空間から低次元空間への投影。「影絵」のようにデータの一部を映し出す。 |
| **固有顔 (Eigenfaces)** | 顔画像をPCAで低次元表現し、比較・認識する画像処理への応用例。 |

### 分離と境界の幾何学：SVMとロジスティック回帰

データをクラスごとに分類するための、幾何学的および統計的なアプローチ。

| キーワード | 説明 |
| --- | --- |
| **マージン最大化** | 二つのクラスを隔てる境界と、最も近いデータ点（サポートベクター）との距離を最大化するSVMの核心アイデア。 |
| **サポートベクター** | 決定境界を「支える」最小限のデータ点集合。 |
| **カーネルトリック** | データを高次元空間へ暗黙的に写像することで、元の空間では非線形なデータを線形分離可能にする手法。 |
| **ロジスティック回帰** | 決定境界ではなく、シグモイド関数を用いて「クラスに属する確率」を直接モデル化する統計的手法。 |

### 離散構造と意味の抽出：トピックモデル

テキストなどの離散的なデータを、トピックという抽象的概念で整理する手法。

| キーワード | 説明 |
| --- | --- |
| **Bag-of-Words (BoW)** | 単語の出現順序を無視し、頻度のみを扱う「単語の袋」としてのデータ表現。 |
| **LDA (Latent Dirichlet Allocation)** | 文書を複数の潜在的なトピックの混合として記述する確率的生成モデル。 |
| **分布的意味論の欠如** | 古典的なBoW手法において、単語同士の意味的な近さが表現に含まれていなかった限界。 |

### 古典的手法の限界と課題

「平らな世界」を前提としたことで見落とされていた構造や、次世代への課題。

| キーワード | 説明 |
| --- | --- |
| **非線形多様体** | スイスロールのように、ユークリッド空間内で巻いたり曲がったりしているデータ本来の形。 |
| **ノルムの呪い** | ベクトルの「長さ」と「方向」が区別されず、意味や確信度が混同されていた問題。 |
| **順序の喪失** | BoWのように、言語の本質である「時間の流れや文脈」を捨ててしまっていた点。 |

## 第2回：ノルムの呪い ～意味と不確実性の未分化～

### ノルム（ベクトルの長さ）を巡る混迷

深層学習の初期から存在する、ベクトルの「大きさ」に複数の意味が混ざり合ってしまう問題に関する概念。

| キーワード | 説明 |
| --- | --- |
| **ノルムの三重の意味** | 「意味の強度」「モデルの確信度」「スケーリングノイズ」の3つが、一つの数値に未分化なまま混在している状態。 |
| **ハブ化 (Hubness)** | ノルムの大きなベクトルが、あらゆる検索クエリで上位に現れてしまう現象。 |
| **確信度の偽装** | Softmaxの出力（確率の尖り方）が、本質的な確信度ではなく、単なるロジットのスケール（ノルム）に左右される問題。 |
| **Layer Normalization** | 各トークンの平均と分散を正規化することで、実質的にノルムを  付近に揃え、この「呪い」を緩和する現代的技術。 |

### 次元の呪い：高次元空間の逆説

次元数が上がることで、我々の直感（ユークリッド幾何）が通用しなくなる幾何学的な性質。

| キーワード | 説明 |
| --- | --- |
| **距離の集中** (Concentration of distances) | 次元が上がるほど、あらゆる点間の距離が期待値付近に集中し、相対的な差が消滅する現象。 |
| **ランダム直交性** | 高次元空間において、ランダムに選ばれた2つのベクトルは、統計的にほぼ90°（直交）をなすという性質。 |
| **赤道への集中** | 高次元球面では、表面積のほとんどが任意の極から見て「真横（赤道付近）」に存在する現象。 |
| **最近傍探索 (kNN) の困難** | すべての点が「だいたい同じ距離」になるため、「近さ」に基づく分類や検索が意味をなさなくなる問題。 |

### 「向き」と「長さ」を分離する試み

ノルムの曖昧さを解消し、情報を幾何学的に整理しようとした歴史的・構造的なアプローチ。

| キーワード | 説明 |
| --- | --- |
| **カプセルネットワーク (Capsule Networks)** | 「向き」で特徴の属性（姿勢など）を、「長さ」で存在確率を明示的に分離して表現しようとしたHintonらの提案。 |
| **squash関数** | ベクトルの向きを保ったまま、長さを0〜1の範囲に非線形に圧縮する関数。 |
| **直交性の祝福** | ランダムな直交性を利用して、互いに干渉しない独立した表現を大量に埋め込めるというポジティブな側面。 |
| **内在次元** | データが実際に分布している低次元多様体の次元。これを見極めることが、次元の呪いを回避する鍵となる。 |

### 数学的・実装的背景

理論の成立条件や、それを支える統計的な法則。

| キーワード | 説明 |
| --- | --- |
| **独立同分布 (i.i.d.)** | 距離の集中や直交性が導かれる前提となる、成分間の独立性と同一分布性。 |
| **球面符号 (Spherical code)** | 球面上の限られた「角度」の中に、どれだけ多くの非干渉なベクトルを詰め込めるかという数学的課題。 |
| **Zipf則** | Word2Vecのノルム分布が単語の頻度に依存する背景にある、自然言語の統計的法則。 |

## 第3回：プラネタリウムの建設 ～極座標へのパラダイムシフト～

### 球面上の学習と設計思想

ベクトルのノルムを固定し、「向き（角度）」のみを情報の自由度とする設計方針。

| キーワード | 説明 |
| --- | --- |
| **球面制約** | すべての表現ベクトルを単位球面（ノルム1）の上に制約する設計。 |
| **nGPT (Normalized GPT)** | Transformerの全レイヤーに球面制約を徹底し、学習効率を劇的に向上させたアーキテクチャ。 |
| **プラネタリウム・メタファー** | 球面をドームに見立て、星（データ点）の距離ではなく、相対的な位置関係（角度）に注目する直感的理解。 |
| **正規化** | ベクトルの幾何学的な長さを1に揃える操作。LayerNormとは異なり、厳密な球面への射影を行う。 |

### 球面上の確率統計

ユークリッド空間における正規分布の概念を、曲がった球面状に拡張した数学的道具。

| キーワード | 説明 |
| --- | --- |
| **von Mises-Fisher (vMF) 分布** | 球面上の「正規分布」に相当する確率分布。 |
| **平均方向** ($\boldsymbol{\mu}$) | vMF分布における分布の中心を示す単位ベクトル。 |
| **集中度** ($\kappa$)** | 分布の鋭さを制御するパラメータ。Softmaxの温度の逆数に対応する。 |
| **方向統計学** | 方向（角度）を持つデータの統計的性質を扱う学問。 |

### 球面における幾何学的指標

球面という正の曲率を持つ空間で「近さ」や「道筋」を定義する概念。

| キーワード | 説明 |
| --- | --- |
| **測地線距離** | 球面上の2点間の最短経路（大円の弧）の長さ。角度  そのものに対応する。 |
| **コサイン類似度** | 単位ベクトル同士の内積。幾何学的には2つのベクトルのなす角の余弦である。 |
| **正の曲率** | 球面が持つ幾何学的性質。三角形の内角の和が180°を超えるなどの特徴を持つ。 |

### 球面上の最適化技術

制約条件（ノルム=1）を維持しながら効率的に学習を進めるための計算手法。

| キーワード | 説明 |
| --- | --- |
| **リーマン勾配** | 球面の接空間に射影された、制約を破らない勾配の方向。 |
| **接空間** ($T_\mathbf{x} S^{d-1}$) | 球面上の点において、球面と直交する「平らな近似空間」。 |
| **射影勾配法 (Retraction)** | 更新で球面から外れたベクトルを、正規化によって再び球面へ引き戻す手法。 |
| **数値安定性とeps** | 混合精度学習（float16等）において、ゼロ除算やアンダーフローを防ぐための微小な補正値。 |

## 第4回：分類の再統一 I ～Softmaxと情報幾何学～

## 第5回：分類の再統一 II ～マージンの幾何学～

## 第6回：Transformerという測量士 ～動的な接続～

## 第7回：不確実性の復権 ～Variance Matters～

## 第8回：時間の発見 ～一撃からの脱却～

## 第9回：拡散と凝縮 ～熱力学との融合～

## 第10回：思考の連鎖 ～推論の軌跡～

## 第11回：感覚の統合 ～異種多様体の結婚～

## 第12回：双曲幾何学 ～負の曲率の世界～

## 第14回：トポロジーという顕微鏡 ～穴とループの発見～

## 第15回：次の時代を設計する

## Appendix 1: 量子化の幾何学

### 量子化の基本概念と目的

連続的な数値を限られたビット数の離散値へ変換する技術とその動機。

| キーワード | 説明 |
| --- | --- |
| **ビット精度** (FP32 / INT4 / 1-bit) | 32ビット浮動小数点から1ビット（2値）まで、重みを表現する情報の細かさ。 |
| **メモリ削減** | 数十億〜数千億のパラメータを持つLLMにおいて、消費メモリを劇的に抑える主要な目的。 |
| **推論高速化** | データ転送量の削減や、専用カーネル（Tensor Core等）の活用による計算の効率化。 |
| **KV cache 量子化** | 長文生成時にメモリを圧迫するKey/Valueキャッシュの容量を削減する実務的アプローチ。 |

### 量子化の幾何学的解釈

重み空間や表現空間が離散化されることで生じる形状の変化。

| キーワード | 説明 |
| --- | --- |
| **重み空間の格子化** | 連続的な空間が離散的な格子点に制限される操作。幾何学的には「射影」と見なせる。 |
| **量子化誤差** $\epsilon = w - \hat{w}$  | 元の値と格子点への射影による「ずれ」。 |
| **決定境界の硬直化** | 柔軟だった境界が、重みの離散化によって階段状や硬直した形状へ変化する現象。 |
| **表現多様体のピクセル化** | 中間層の表現が分布する多様体の局所的な分解能が低下すること。 |
| **球面上の格子** | nGPTのような球面制約下での量子化。ノルム1を維持するための再正規化などの課題を伴う。 |

### 量子化の手法とアルゴリズム

幾何学的な歪みを最小限に抑えつつ離散化を行うための具体的な技術。

| キーワード | 説明 |
| --- | --- |
| **PTQ** (Post-Training Quantization) | 学習済みモデルを事後的に量子化する手法。GPTQやAWQなどが含まれる。 |
| **QAT** (Quantization-Aware Training) | 量子化の影響を考慮しながら再学習する手法。STE（ストレートスルー推定量）が利用される。 |
| **最近傍丸め (Round-to-Nearest)** | 最も近い格子点へ飛ばす、最も単純な最短距離射影。 |
| **SmoothQuant** | 重みとアクティベーションの分散を座標変換によって均等化し、量子化しやすくする手法。 |
| **BitNet / 1.58-bit** | 重みを{-1, 1}や{-1, 0, 1}に制限する極端な量子化。行列積を加減算に置き換える。 |

### 誤差分析と頑健性

量子化による性能劣化を幾何学的・構造的な視点から評価する指標。

| キーワード | 説明 |
| --- | --- |
| **層ごとの感度** | 埋め込み層や出力層は感度が高く、FFN層は比較的頑健であるといった、多様体の曲率や役割による依存性。 |
| **過剰パラメータ化** | モデルの冗長性により、多少の量子化誤差が相殺され性能が維持される背景。 |
| **キャリブレーション** | 量子化パラメータ（スケール等）を決定するために少量のデータで分布を確認する工程。 |
| **Hausdorff距離** | 量子化前後で決定境界がどれだけ「ずれた」かを測る幾何学的指標。 |

## Appendix 2: 多様体の純度問題: 幾何学がまだ解けていない課題

### 多様体の「純度」とその定義

幾何学的な空間設計（形式）と、そこに格納されるデータの中身（内容）の乖離に関する概念。

| キーワード | 説明 |
| --- | --- |
| **純度** | 表現空間において、論理的・事実的な整合性に反するサンプルがどの程度混入し、学習結果に影響を与えているかの指標。 |
| **形式の安定と内容の真偽** | 正規化（球面化）は計算形式を安定させるが、その方向が「正しい」かどうか（真偽）には中立であるという本質的限界。 |
| **「正しさ」の3類型** | 論理整合性（推論規則）、事実整合性（世界知識）、規範整合性（価値判断）の区別。 |
| **影響度** | 特定のサンプルを除去・変更した際の、検証誤差や推論安定性の変化量。 |

### 既存のデータ選別手法と幾何学的解釈

現在利用されているデータクレンジング手法を、幾何学的な測定量の視点で再定義したもの。

| キーワード | 説明 |
| --- | --- |
| **表現距離と損失距離** | 埋め込み空間での近さ（表現距離）と、予測誤差の大きさ（損失距離/EL2N）の区別。 |
| **EL2Nスコア** | 予測誤差の大きさを「距離」の代理指標としてデータを選別する手法。 |
| **Influence Functions** | データ除去時の損失変化をHessian近傍の「曲率」として逆算し、影響度を測る手法。 |
| **kNN外れ値検出** | 表現空間における「密度」の低さを利用して、疎領域のデータを検出する手法。 |
| **TDA（トポロジカルデータアナリシス）** | データの「位相（穴の存在など）」から異常を検知する試み。 |

### 幾何学的選別の障壁と限界

幾何学単独ではデータの真偽を判定できない原理的な理由。

| キーワード | 説明 |
| --- | --- |
| **原理的な識別不能性** | 幾何学は「形（内在的性質）」を測るが、そこに付与された「意味（外部参照）」は測れないという制約。 |
| **論理と幾何の断絶** | 幾何学的な「三角不等式」が、論理学的な「含意（推移律）」を必ずしも保証しないという問題。 |
| **鶏と卵問題** | 異常検知の基準となる「正しい多様体」自体が、汚れたデータで学習されているという循環依存。 |
| **次元の呪い** | 高次元空間において距離の集中や推定誤差の爆発が起き、測定量の信頼性が低下する現象。 |

### 将来の研究方向と補完技術

幾何学の限界を乗り越え、データの純度を高めるためのアプローチ。

| キーワード | 説明 |
| --- | --- |
| **Tool Use（外部検証）** | 計算エンジンや検索エンジンを用い、幾何学の外側で事実を検証する必然性。 |
| **合成データ** | 論理ルールに基づき、最初から「正しい」多様体を設計・生成する手法。 |
| **論理制約の埋め込み学習** | 推移律などの論理規則を損失関数に組み込み、表現距離に制約を与える試み。 |
| **動態論への接続** | 静的な「配置の歪み」としての異常を、推論時の「軌道のトラップ（幻覚）」として捉え直す動的な視点。 |
