<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 520 480" font-family="'STIX Two Math', 'Latin Modern Math', 'Cambria Math', serif">
  <defs>
    <style>
      .label { font-size: 14px; fill: #1a1a2e; }
      .label-sm { font-size: 12px; fill: #555; }
      .label-math { font-size: 15px; fill: #1a1a2e; font-style: italic; }
      .title { font-size: 16px; fill: #1a1a2e; font-weight: 600; }
      .boundary-line { stroke: #e74c3c; stroke-width: 2.2; fill: none; }
      .interior-fill { fill: #dceefb; opacity: 0.55; }
      .interior-stroke { stroke: #3498db; stroke-width: 1.2; stroke-dasharray: 5,3; fill: none; }
      .annotation { font-size: 11.5px; fill: #444; }
      .legend-box { rx: 4; ry: 4; stroke: #ccc; stroke-width: 0.8; fill: #fafafa; }
    </style>
    <!-- Subtle grid pattern for interior -->
    <pattern id="intGrid" x="0" y="0" width="12" height="12" patternUnits="userSpaceOnUse">
      <path d="M 12 0 L 0 0 0 12" fill="none" stroke="#b8d4e8" stroke-width="0.3"/>
    </pattern>
  </defs>

  <!-- Title -->
  <text x="260" y="30" text-anchor="middle" class="title">確率単体 Δ² （K = 3）</text>

  <!-- ===== Triangle geometry ===== -->
  <!-- Vertices: A(260,60) top, B(80,370) bottom-left, C(440,370) bottom-right -->
  <g transform="translate(0,15)">
    <!-- Interior fill with pattern -->
    <polygon points="260,60 80,370 440,370" class="interior-fill"/>
    <polygon points="260,60 80,370 440,370" fill="url(#intGrid)"/>

    <!-- Boundary (red, solid) -->
    <polygon points="260,60 80,370 440,370" class="boundary-line"/>

    <!-- Dashed interior contour (slightly inset) to show open interior -->
    <polygon points="260,82 100,358 420,358" class="interior-stroke"/>

    <!-- ===== Vertices (one-hot) ===== -->
    <!-- Vertex A: p=(1,0,0) -->
    <circle cx="260" cy="60" r="6" fill="#e74c3c"/>
    <text x="260" y="44" text-anchor="middle" class="label-math">p₁ = 1</text>
    <text x="290" y="55" class="label-sm">(1, 0, 0)</text>

    <!-- Vertex B: p=(0,1,0) -->
    <circle cx="80" cy="370" r="6" fill="#e74c3c"/>
    <text x="72" y="395" text-anchor="middle" class="label-math">p₂ = 1</text>
    <text x="72" y="410" text-anchor="middle" class="label-sm">(0, 1, 0)</text>

    <!-- Vertex C: p=(0,0,1) -->
    <circle cx="440" cy="370" r="6" fill="#e74c3c"/>
    <text x="448" y="395" text-anchor="middle" class="label-math">p₃ = 1</text>
    <text x="448" y="410" text-anchor="middle" class="label-sm">(0, 0, 1)</text>

    <!-- ===== Center (uniform distribution) ===== -->
    <circle cx="260" cy="267" r="5.5" fill="#2ecc71"/>
    <text x="280" y="260" class="label" fill="#1a7a45">一様分布</text>
    <text x="280" y="276" class="label-sm" fill="#1a7a45">(1/3, 1/3, 1/3)</text>
    <text x="280" y="292" class="annotation" fill="#1a7a45">H = log 3（最大）</text>

    <!-- ===== Sample interior point (Softmax output) ===== -->
    <circle cx="310" cy="190" r="4.5" fill="#3498db"/>
    <text x="325" y="188" class="label" fill="#2471a3">Softmax出力</text>
    <text x="325" y="203" class="label-sm" fill="#2471a3">(常に内部)</text>

    <!-- Another sample point near boundary -->
    <circle cx="160" cy="330" r="4" fill="#3498db" opacity="0.6"/>
    <line x1="160" y1="330" x2="115" y2="340" stroke="#3498db" stroke-width="0.8" stroke-dasharray="3,2"/>
    <text x="42" y="343" class="annotation" fill="#2471a3">p₂ ≈ 0.85</text>
    <text x="42" y="356" class="annotation" fill="#2471a3">（境界に近いが</text>
    <text x="42" y="369" class="annotation" fill="#2471a3">　到達しない）</text>

    <!-- ===== Boundary labels ===== -->
    <!-- Edge AB midpoint -->
    <text x="142" y="210" text-anchor="middle" transform="rotate(-60,142,210)" class="annotation" fill="#c0392b">境界：p₃ = 0</text>
    <!-- Edge BC midpoint -->
    <text x="260" y="388" text-anchor="middle" class="annotation" fill="#c0392b">境界：p₁ = 0</text>
    <!-- Edge AC midpoint -->
    <text x="378" y="210" text-anchor="middle" transform="rotate(60,378,210)" class="annotation" fill="#c0392b">境界：p₂ = 0</text>

    <!-- ===== Interior label ===== -->
    <text x="215" y="320" class="label" fill="#2471a3" opacity="0.7">int(Δ²)</text>
    <text x="205" y="335" class="annotation" fill="#2471a3" opacity="0.7">滑らかな多様体</text>
  </g>

  <!-- ===== Legend ===== -->
  <rect x="10" y="440" width="500" height="36" class="legend-box"/>
  <circle cx="30" cy="458" r="5" fill="#e74c3c"/>
  <text x="40" y="462" class="annotation">頂点・境界（特異、H = 0）</text>
  <line x1="165" y1="458" x2="185" y2="458" stroke="#3498db" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="190" y="462" class="annotation">開内部（滑らかな多様体）</text>
  <circle cx="345" cy="458" r="5" fill="#2ecc71"/>
  <text x="355" y="462" class="annotation">中心（一様分布、H = log K）</text>
</svg>
