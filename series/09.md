# 第9回：拡散と凝縮 ～熱力学との融合～

## 注意事項

- 標準的な拡散モデル（DDPM等）はユークリッド空間 $\mathbb{R}^d$ 上で定義される。最終状態はガウス分布。
- 「球面上の拡散」は別の定式化であり、標準手法とは異なる。
- SDE/ODEの式は概念的な表現であり、実装では離散化・近似が入る。

## トピック

拡散モデル（Diffusion Models）と SDE/ODE

## 内容

- **拡散モデルの直感:**
    - 「インクを水に垂らすと拡散する（forward）」
    - 「拡散した水からインクを取り出す（reverse）」
    - この逆再生が生成プロセス
- **標準的な拡散モデル（ $\mathbb{R}^d$ 上）:**
    - **Forward Process（SDE）:**
        - $d\mathbf{x}_t = -\frac{\beta_t}{2}\mathbf{x}_t dt + \sqrt{\beta_t} d\mathbf{W}_t$
            - $\beta_t$ ：ノイズスケジュール
            - $d\mathbf{W}_t$ ：ブラウン運動（ランダムノイズ）
        - **最終状態：ガウス分布** $\mathcal{N}(0, I)$ （球面上の一様分布ではない）
    - **Reverse Process（逆SDE）:**
        - ここで書くのは **VP-SDE（variance preserving）系の連続時間表現の"概念式"**
        - Reverse-time SDE は **スコア関数** $\nabla_{\mathbf{x}} \log p_t(\mathbf{x})$ を含む漂流項を持つ
        - 霧の中から星が凝縮していく「逆時間の軌跡」
    - **確率フローODE:**
        - SDEの決定論的版（ノイズ項を消去）
        - 対応する SDE からノイズ項を除いた **決定論的 ODE** として得られる
        - サンプリング高速化（DDIM, DPM-Solver等）の背景
- **球面上の拡散モデル（発展的トピック・別定式化）:**
    - 標準的拡散（ $\mathbb{R}^d$ ）とは **別の定式化**
    - 球面上のブラウン運動（heat kernel 等）を用いる
    - 最終状態：球面上の一様分布
    - 研究は進行中だが、主流は依然として $\mathbb{R}^d$ 上の拡散が中心
- **深層学習以前との接続:**
    - **エネルギーベースモデル（EBM）の復活（見方の一つ）**
        - 昔：計算が遅すぎて実用が難しかった
        - 今：スコアマッチングと拡散モデルで実用化が進んだ
    - Langevin dynamics との類似性
- **幾何学的視点の価値:**
    - ガウスへ拡散する場合でも、「確率分布の時間発展」という視点は強い
    - スコア関数は「確率の流れの方向」を表す（幾何学的解釈）
- 「ベクトルを足し引きする」直感の復権
    - 昔はword2vecの「王 - 男 + 女 = 女王」が、ある種のトイ・プロブレム（おもちゃのような例題）に見えた。
    - しかし、今の確率フローODEの世界では、これは**「意味の方向性（ベクトル場）に沿って状態を積分する」**という、極めて厳密な力学計算として再評価されている。
    - 「昔の描いた直線のベクトルは、実は巨大な多様体の上を走る『接ベクトル』の断片だった」
    - 今のAIは、その断片を無数に繋ぎ合わせて、滑らかな「思考の道」を作れるようになっただけ

## 実装ノート

- 標準的な実装（DDPM, DDIM）は $\mathbb{R}^d$ 上
- 球面拡散を試すなら専用実装が必要（研究段階）

## メッセージ

拡散は「確率分布の時間発展」だが、空間選択（ $\mathbb{R}^d$ vs 球面）は別問題
